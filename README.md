spacewalk-debian-sync
=====================

An improvised repo-sync to bring Debian packages into Spacewalk

**spacewalk-add-debian-multiarch-header.py** A script that adds the missing Multi-Arch header from the original Packages.gz file from Debian to the Packages.gz file generated by Spacewalk.

Spacewalk is currently still missing several package headers, which are available in Debian. Currently, **Multi-Arch** is one that really makes trouble if it is missing. See https://bugzilla.redhat.com/show_bug.cgi?id=1243387

To get Debian 9 and higher working with Spacewalk, you need to extract the Multi-Arch header from the packages, which is done with this modified version of **spacewalk-debian-sync.pl**

After the synchronization is done, you have to wait some time to let Spacewalk re-create the **Packages.gz** files for the channels that got updated.

Then run

```
spacewalk-add-debian-multiarch-header.py /var/cache/rhn/repodata/<channel>/Packages /tmp/<channel>
```

This creates **Packages.new** within the same directory which can then be gziped with

```
gzip -c /var/cache/rhn/repodata/<channel>/Packages.new > /var/cache/rhn/repodata/<channel>/Packages.gz && touch -r /var/cache/rhn/repodata/<channel>/Packages /var/cache/rhn/repodata/<channel>/Packages.gz 
```
